<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="utf-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>
    <title>목록</title>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet"/>
    <link th:href="@{/css/styles.css}" rel="stylesheet"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script crossorigin="anonymous" src="https://use.fontawesome.com/releases/v6.3.0/js/all.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/sketchy/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/studyCommon.css}"/>
</head>

<body class="sb-nav-fixed">

<script th:inline="javascript">
    const post_id = [[${post.id}]];
</script>

<th:block sec:authorize="isAuthenticated()" th:with="userId=${#authentication.getPrincipal().getUser().getId()}">
    <script th:inline="javascript">
        const logged_id = [[${userId}]];
    </script>
</th:block>

<th:block sec:authorize="isAnonymous()">
    <script th:inline="javascript">
        const logged_id = 0;
    </script>
</th:block>

<th:block th:insert="~{common/menubar::menubar}"></th:block>
<div id="layoutSidenav">
    <!-- sidebar -->
    <th:block th:insert="~{common/sidebar::sidebar}"></th:block>

    <div id="layoutSidenav_content"><br>
        <main class="main_box align-self-center">
            <a th:href="@{/study/list}"><i class="fa-solid fa-arrow-left" style="color: #aaaaaa; font-size: 30px;"
                                           type="button"></i></a>
            <!-- 이전 히스토리로 리로드 -->
            <div class="board_detail" style="width: 576px;">
                <div class="card mb-3">
                    <div class="card-header">
                        <h3 class="title col-11 justify-content-center" style="margin-bottom: -12px"
                            th:text="${post.title}"></h3>

                        <div class="btn btn-link position-absolute end-0 translate-middle-y">
                                <span class="favorite" data-favorite="off">
                                    <i class="fa-regular fa-star fa-lg" style="color: #ffd43b;"></i>
                                </span>
                                <span class="favorite" data-favorite="on">
                                    <i class="fa-solid fa-star fa-lg" style="color: #ffd43b;"></i>
                                </span>
                        </div>
                    </div>


                    <div class="card-body">
                        <div class="info_uppper_box">
                            <h6 class="card-title" style="float: right;"
                                th:text="${post.user.name}+' | '+${#temporals.format(post.regDate,'yyyy-MM-dd')}"></h6>
                        </div>
                        <br>
                        <hr style="margin-top: 5px">
                        <br>
                        <section class="study_info ms-3" style="margin-top: -25px;">
                            <table class="table table-borderless">
                                <tr>
                                    <th scope="col">모집 인원</th>
                                    <th scope="col" th:text="${post.member}+명"></th>
                                    <th scope="col">모집 마감일</th>
                                    <th scope="col" th:text="${#temporals.format(post.enddate,'yyyy-MM-dd')}"></th>
                                </tr>
                                <tr>
                                    <th scope="col">스터디 언어</th>
                                    <th scope="col">
                                        <span th:each="skill : ${post.skillList}">
                                            <th:block th:utext="${skill.imageUrl}"></th:block>
                                        </span>
                                    </th>
                                    <th scope="col">포지션</th>
                                    <th scope="col" th:text="${post.position}"></th>
                                </tr>


                                <tr>
                                    <th scope="col">스터디 시작일</th>
                                    <th scope="col" th:text="${#temporals.format(post.startdate,'yyyy-MM-dd')}"></th>
                                    <!--                                                    <th scope="col">스터디 기간</th>-->
                                    <!--                                                    <th scope="col">3개월</th>-->
                                </tr>
                            </table>
                        </section>
                        <hr>
                    </div>

                    <div class="card-body" style="margin-top: -30px;">
                        <h3>
                            About our Study
                        </h3>
                        <p class="card-text" th:utext="${post.content}">
                        </p>
                    </div>
                    <div class="list_bottom_box mb-2">
                        <div class="list box d-flex justify-content-end me-3">
                            <a class="card-link" th:href="@{'/study/update/'+${post.id}}" style="text-decoration: none;">Edit</a>
                            <!-- 작성자만 해당 버튼 활성화 -->
                            <form method="POST" name="frmDelete" th:action="@{/study/delete}">
                                <input name="id" th:value="${post.id}" type="hidden">
                                <button id="btnDel" style="color: red; border:none; background-color:white;"
                                        type="submit">Delete
                                    <!-- 작성자만 해당 버튼 활성화 -->
                                </button>
                            </form>
                        </div>
                        <div class="viewcnt_box ms-3" style="font-size: 15px; margin-top: -23px;">
                            <i class="view_eye fas fa-eye"></i>
                            <a class="view_cnt text-decoration-none" th:text="${post.viewCnt}"></a>
                        </div>
                    </div>
                </div>

                <!-- Comments box -->
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title mb-3">Comments</h4>
                        <h6 class="card-subtitle text-muted">User1 <a class="write_date"
                                                                      style="font-size: 12px; font-weight: lighter; text-decoration:none">
                            [2023.05.10]</a></h6>
                        <p class="card-text">Hi~ I wanna join study club!</p>
                        <h6 class="card-subtitle text-muted">User2 <a class="write_date"
                                                                      style="font-size: 12px; font-weight: lighter; text-decoration:none">
                            [2023.11.11]</a></h6>
                        <p class="card-text">Hello. Can I get more information about study?
                            <i class="fa-solid fa-delete-left" style="color: #ff0505; margin-top: 5px;"></i>
                        </p>
                        <div class="form-group">
                            <label class="col-form-label" for="inputDefault">Add Comment</label>
                            <input class="form-control" id="inputDefault" placeholder="Default input" type="text">
                            <button class="btn btn-primary btn-sm" style="float: right" type="button">Add comment
                            </button> <!-- 댓글작성 버튼 생성 -->
                        </div>

                    </div>
                </div>
            </div>

            <th:block th:insert="~{common/chatbot::chatbot}"></th:block>
        </main>

        <!-- Footer -->
        <th:block th:insert="~{common/footer::footer}"></th:block>

    </div>
</div>
<script crossorigin="anonymous"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/studyDetail.js}"></script>
</body>
</html>